{"version":3,"file":"flowGraphConsoleLogBlock-DZGh3WAT.esm.min.js","sources":["../../../../../dev/core/dist/FlowGraph/Blocks/Execution/flowGraphConsoleLogBlock.js"],"sourcesContent":["import { FlowGraphExecutionBlockWithOutSignal } from \"../../flowGraphExecutionBlockWithOutSignal\";\nimport { RichTypeAny } from \"../../flowGraphRichTypes\";\nimport { RegisterClass } from \"../../../Misc/typeStore\";\nimport { Logger } from \"core/Misc/logger\";\n/**\n * Block that logs a message to the console.\n */\nexport class FlowGraphConsoleLogBlock extends FlowGraphExecutionBlockWithOutSignal {\n    constructor(config) {\n        super(config);\n        this.message = this.registerDataInput(\"message\", RichTypeAny);\n        this.logType = this.registerDataInput(\"logType\", RichTypeAny, \"log\");\n        if (config?.messageTemplate) {\n            const matches = this._getTemplateMatches(config.messageTemplate);\n            for (const match of matches) {\n                this.registerDataInput(match, RichTypeAny);\n            }\n        }\n    }\n    /**\n     * @internal\n     */\n    _execute(context) {\n        const typeValue = this.logType.getValue(context);\n        const messageValue = this._getMessageValue(context);\n        if (typeValue === \"warn\") {\n            Logger.Warn(messageValue);\n        }\n        else if (typeValue === \"error\") {\n            Logger.Error(messageValue);\n        }\n        else {\n            Logger.Log(messageValue);\n        }\n        // activate the output flow block\n        this.out._activateSignal(context);\n    }\n    /**\n     * @returns class name of the block.\n     */\n    getClassName() {\n        return \"FlowGraphConsoleLogBlock\" /* FlowGraphBlockNames.ConsoleLog */;\n    }\n    _getMessageValue(context) {\n        if (this.config?.messageTemplate) {\n            let template = this.config.messageTemplate;\n            const matches = this._getTemplateMatches(template);\n            for (const match of matches) {\n                const value = this.getDataInput(match)?.getValue(context);\n                if (value !== undefined) {\n                    // replace all\n                    template = template.replace(new RegExp(`\\\\{${match}\\\\}`, \"g\"), value.toString());\n                }\n            }\n            return template;\n        }\n        else {\n            return this.message.getValue(context);\n        }\n    }\n    _getTemplateMatches(template) {\n        const regex = /\\{([^}]+)\\}/g;\n        const matches = [];\n        let match;\n        while ((match = regex.exec(template)) !== null) {\n            matches.push(match[1]);\n        }\n        return matches;\n    }\n}\nRegisterClass(\"FlowGraphConsoleLogBlock\" /* FlowGraphBlockNames.ConsoleLog */, FlowGraphConsoleLogBlock);\n//# sourceMappingURL=flowGraphConsoleLogBlock.js.map"],"names":["FlowGraphConsoleLogBlock","FlowGraphExecutionBlockWithOutSignal","constructor","config","super","this","message","registerDataInput","RichTypeAny","logType","messageTemplate","matches","_getTemplateMatches","match","_execute","context","typeValue","getValue","messageValue","_getMessageValue","Logger","Warn","Error","Log","out","_activateSignal","getClassName","template","value","getDataInput","undefined","replace","RegExp","toString","regex","exec","push","RegisterClass"],"mappings":"gOAOO,MAAMA,UAAiCC,EAC1C,WAAAC,CAAYC,GAIR,GAHAC,MAAMD,GACNE,KAAKC,QAAUD,KAAKE,kBAAkB,UAAWC,GACjDH,KAAKI,QAAUJ,KAAKE,kBAAkB,UAAWC,EAAa,OAC1DL,GAAQO,gBAAiB,CACzB,MAAMC,EAAUN,KAAKO,oBAAoBT,EAAOO,iBAChD,IAAK,MAAMG,KAASF,EAChBN,KAAKE,kBAAkBM,EAAOL,EAE9C,CACA,CAII,QAAAM,CAASC,GACL,MAAMC,EAAYX,KAAKI,QAAQQ,SAASF,GAClCG,EAAeb,KAAKc,iBAAiBJ,GACzB,SAAdC,EACAI,EAAOC,KAAKH,GAEO,UAAdF,EACLI,EAAOE,MAAMJ,GAGbE,EAAOG,IAAIL,GAGfb,KAAKmB,IAAIC,gBAAgBV,EACjC,CAII,YAAAW,GACI,MAAO,0BACf,CACI,gBAAAP,CAAiBJ,GACb,GAAIV,KAAKF,QAAQO,gBAAiB,CAC9B,IAAIiB,EAAWtB,KAAKF,OAAOO,gBAC3B,MAAMC,EAAUN,KAAKO,oBAAoBe,GACzC,IAAK,MAAMd,KAASF,EAAS,CACzB,MAAMiB,EAAQvB,KAAKwB,aAAahB,IAAQI,SAASF,QACnCe,IAAVF,IAEAD,EAAWA,EAASI,QAAQ,IAAIC,OAAO,MAAMnB,OAAY,KAAMe,EAAMK,YAEzF,CACY,OAAON,CACnB,CAEY,OAAOtB,KAAKC,QAAQW,SAASF,EAEzC,CACI,mBAAAH,CAAoBe,GAChB,MAAMO,EAAQ,eACRvB,EAAU,GAChB,IAAIE,EACJ,KAA0C,QAAlCA,EAAQqB,EAAMC,KAAKR,KACvBhB,EAAQyB,KAAKvB,EAAM,IAEvB,OAAOF,CACf,EAEA0B,EAAc,2BAAiErC"}