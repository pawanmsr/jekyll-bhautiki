import{b1 as e,b as s,bS as t,bR as n}from"./index-C7lpuH7l.esm.min.js";import{GLTFLoader as o}from"./glTFLoader-Cy3hFpAv.esm.min.js";import"./bone-C8BOn9ne.esm.min.js";import"./skeleton-CpeT1KDV.esm.min.js";import"./rawTexture-GcKYJ37d.esm.min.js";import"./assetContainer-BpinJ-Pb.esm.min.js";import"./objectModelMapping-EW6prSP3.esm.min.js";const i="KHR_materials_volume";class a{constructor(e){this.name=i,this.order=173,this._loader=e,this.enabled=this._loader.isExtensionUsed(i),this.enabled&&this._loader._disableInstancedMesh++}dispose(){this.enabled&&this._loader._disableInstancedMesh--,this._loader=null}loadMaterialPropertiesAsync(e,s,t){return o.LoadExtensionAsync(e,s,this.name,(async(n,o)=>{const i=new Array;return i.push(this._loader.loadMaterialPropertiesAsync(e,s,t)),i.push(this._loadVolumePropertiesAsync(n,s,t,o)),await Promise.all(i).then((()=>{}))}))}_loadVolumePropertiesAsync(t,n,o,i){const a=this._loader._getOrCreateMaterialAdapter(o);if(0===a.transmissionWeight&&0===a.subsurfaceWeight||!i.thicknessFactor)return Promise.resolve();const r=void 0!==i.attenuationDistance?i.attenuationDistance:Number.MAX_VALUE,l=void 0!==i.attenuationColor&&3==i.attenuationColor.length?e.FromArray(i.attenuationColor):e.White(),m=new s(-Math.log(l.r),-Math.log(l.g),-Math.log(l.b));m.scaleInPlace(1/Math.max(r,.001)),a.extinctionCoefficient=m,a.transmissionDepth=r,a.transmissionColor=l,a.volumeThickness=i.thicknessFactor??0;const h=new Array;return i.thicknessTexture&&(i.thicknessTexture.nonColorData=!0,h.push(this._loader.loadTextureInfoAsync(`${t}/thicknessTexture`,i.thicknessTexture,(e=>{e.name=`${o.name} (Thickness)`,a.volumeThicknessTexture=e})))),Promise.all(h).then((()=>{}))}}t(i),n(i,!0,(e=>new a(e)));export{a as KHR_materials_volume};
//# sourceMappingURL=KHR_materials_volume-BTc3vq6e.esm.min.js.map
