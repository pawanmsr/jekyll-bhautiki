{"version":3,"file":"abstractSoundSource-WGnl6Tud.esm.min.js","sources":["../../../../../dev/core/dist/AudioV2/abstractAudio/abstractSoundSource.js"],"sourcesContent":["import { AbstractAudioOutNode } from \"./abstractAudioOutNode\";\n/**\n * Abstract class representing a sound in the audio engine.\n */\nexport class AbstractSoundSource extends AbstractAudioOutNode {\n    constructor(name, engine, options, nodeType = 2 /* AudioNodeType.HAS_OUTPUTS */) {\n        super(name, engine, nodeType);\n        this._spatialAutoUpdate = true;\n        this._spatialMinUpdateTime = 0;\n        this._outBus = null;\n        this._spatial = null;\n        this._onOutBusDisposed = null;\n        if (typeof options.spatialAutoUpdate === \"boolean\") {\n            this._spatialAutoUpdate = options.spatialAutoUpdate;\n        }\n        if (typeof options.spatialMinUpdateTime === \"number\") {\n            this._spatialMinUpdateTime = options.spatialMinUpdateTime;\n        }\n    }\n    /**\n     * The output bus for the sound.\n     * @see {@link AudioEngineV2.defaultMainBus}\n     */\n    get outBus() {\n        return this._outBus;\n    }\n    set outBus(outBus) {\n        if (this._outBus === outBus) {\n            return;\n        }\n        if (this._outBus) {\n            if (this._onOutBusDisposed) {\n                this._outBus.onDisposeObservable.removeCallback(this._onOutBusDisposed);\n                this._onOutBusDisposed = null;\n            }\n            if (!this._disconnect(this._outBus)) {\n                throw new Error(\"Disconnect failed\");\n            }\n        }\n        this._outBus = outBus;\n        if (this._outBus) {\n            this._onOutBusDisposed = () => {\n                this._outBus = null;\n            };\n            this._outBus.onDisposeObservable.add(this._onOutBusDisposed);\n            if (!this._connect(this._outBus)) {\n                throw new Error(\"Connect failed\");\n            }\n        }\n    }\n    /**\n     * The spatial audio features.\n     */\n    get spatial() {\n        if (this._spatial) {\n            return this._spatial;\n        }\n        return this._initSpatialProperty();\n    }\n    /**\n     * Releases associated resources.\n     */\n    dispose() {\n        super.dispose();\n        this._spatial?.dispose();\n        this._spatial = null;\n        if (this._outBus && this._onOutBusDisposed) {\n            this._outBus.onDisposeObservable.removeCallback(this._onOutBusDisposed);\n            this._onOutBusDisposed = null;\n        }\n        this._outBus = null;\n    }\n    _initSpatialProperty() {\n        return (this._spatial = this._createSpatialProperty(this._spatialAutoUpdate, this._spatialMinUpdateTime));\n    }\n    /** @internal */\n    get _isSpatial() {\n        return this._spatial !== null;\n    }\n    set _isSpatial(value) {\n        if (value && !this._spatial) {\n            this._initSpatialProperty();\n        }\n        else if (!value && this._spatial) {\n            this._spatial.dispose();\n            this._spatial = null;\n        }\n    }\n}\n//# sourceMappingURL=abstractSoundSource.js.map"],"names":["AbstractSoundSource","AbstractAudioOutNode","constructor","name","engine","options","nodeType","super","this","_spatialAutoUpdate","_spatialMinUpdateTime","_outBus","_spatial","_onOutBusDisposed","spatialAutoUpdate","spatialMinUpdateTime","outBus","onDisposeObservable","removeCallback","_disconnect","Error","add","_connect","spatial","_initSpatialProperty","dispose","_createSpatialProperty","_isSpatial","value"],"mappings":"+DAIO,MAAMA,UAA4BC,EACrC,WAAAC,CAAYC,EAAMC,EAAQC,EAASC,EAAW,GAC1CC,MAAMJ,EAAMC,EAAQE,GACpBE,KAAKC,oBAAqB,EAC1BD,KAAKE,sBAAwB,EAC7BF,KAAKG,QAAU,KACfH,KAAKI,SAAW,KAChBJ,KAAKK,kBAAoB,KACgB,kBAA9BR,EAAQS,oBACfN,KAAKC,mBAAqBJ,EAAQS,mBAEM,iBAAjCT,EAAQU,uBACfP,KAAKE,sBAAwBL,EAAQU,qBAEjD,CAKI,UAAIC,GACA,OAAOR,KAAKG,OACpB,CACI,UAAIK,CAAOA,GACP,GAAIR,KAAKG,UAAYK,EAArB,CAGA,GAAIR,KAAKG,UACDH,KAAKK,oBACLL,KAAKG,QAAQM,oBAAoBC,eAAeV,KAAKK,mBACrDL,KAAKK,kBAAoB,OAExBL,KAAKW,YAAYX,KAAKG,UACvB,MAAM,IAAIS,MAAM,qBAIxB,GADAZ,KAAKG,QAAUK,EACXR,KAAKG,UACLH,KAAKK,kBAAoB,KACrBL,KAAKG,QAAU,MAEnBH,KAAKG,QAAQM,oBAAoBI,IAAIb,KAAKK,oBACrCL,KAAKc,SAASd,KAAKG,UACpB,MAAM,IAAIS,MAAM,iBAjBhC,CAoBA,CAII,WAAIG,GACA,OAAIf,KAAKI,SACEJ,KAAKI,SAETJ,KAAKgB,sBACpB,CAII,OAAAC,GACIlB,MAAMkB,UACNjB,KAAKI,UAAUa,UACfjB,KAAKI,SAAW,KACZJ,KAAKG,SAAWH,KAAKK,oBACrBL,KAAKG,QAAQM,oBAAoBC,eAAeV,KAAKK,mBACrDL,KAAKK,kBAAoB,MAE7BL,KAAKG,QAAU,IACvB,CACI,oBAAAa,GACI,OAAQhB,KAAKI,SAAWJ,KAAKkB,uBAAuBlB,KAAKC,mBAAoBD,KAAKE,sBAC1F,CAEI,cAAIiB,GACA,OAAyB,OAAlBnB,KAAKI,QACpB,CACI,cAAIe,CAAWC,GACPA,IAAUpB,KAAKI,SACfJ,KAAKgB,wBAECI,GAASpB,KAAKI,WACpBJ,KAAKI,SAASa,UACdjB,KAAKI,SAAW,KAE5B"}