import{A as t}from"./abstractAudioBus-BqXOv3K8.esm.min.js";import{_ as s,b as e,c as i,d as o}from"./spatialWebAudio-B42xkSFp.esm.min.js";import"./webAudioBaseSubGraph-BwJfROV_.esm.min.js";import"./audioEngine-Dxu8PeXf.esm.min.js";import"./index-C7lpuH7l.esm.min.js";class a extends t{constructor(t,s,e){super(t,s),this._spatialAutoUpdate=!0,this._spatialMinUpdateTime=0,this._outBus=null,this._spatial=null,this._onOutBusDisposed=()=>{this.outBus=this.engine.defaultMainBus},"boolean"==typeof e.spatialAutoUpdate&&(this._spatialAutoUpdate=e.spatialAutoUpdate),"number"==typeof e.spatialMinUpdateTime&&(this._spatialMinUpdateTime=e.spatialMinUpdateTime)}get outBus(){return this._outBus}set outBus(t){if(this._outBus!==t){if(this._outBus&&(this._outBus.onDisposeObservable.removeCallback(this._onOutBusDisposed),!this._disconnect(this._outBus)))throw new Error("Disconnect failed");if(this._outBus=t,this._outBus&&(this._outBus.onDisposeObservable.add(this._onOutBusDisposed),!this._connect(this._outBus)))throw new Error("Connect failed")}}get spatial(){return this._spatial?this._spatial:this._initSpatialProperty()}dispose(){super.dispose(),this._spatial?.dispose(),this._spatial=null,this._outBus=null}_initSpatialProperty(){return this._spatial=this._createSpatialProperty(this._spatialAutoUpdate,this._spatialMinUpdateTime)}}class u extends a{constructor(t,s,e){super(t,s,e),this._stereo=null,this._subGraph=new u._SubGraph(this)}async _initAsync(t){t.outBus?this.outBus=t.outBus:(await this.engine.isReadyPromise,this.outBus=this.engine.defaultMainBus),await this._subGraph.initAsync(t),s(t)&&this._initSpatialProperty(),this.engine._addNode(this)}dispose(){super.dispose(),this._stereo=null,this.engine._removeNode(this)}get _inNode(){return this._subGraph._inNode}get _outNode(){return this._subGraph._outNode}get stereo(){return this._stereo??(this._stereo=new e(this._subGraph))}getClassName(){return"_WebAudioBus"}_createSpatialProperty(t,s){return new i(this._subGraph,t,s)}_connect(t){return!!super._connect(t)&&(t._inNode&&this._outNode?.connect(t._inNode),!0)}_disconnect(t){return!!super._disconnect(t)&&(t._inNode&&this._outNode?.disconnect(t._inNode),!0)}}u._SubGraph=class extends o{get _downstreamNodes(){return this._owner._downstreamNodes??null}get _upstreamNodes(){return this._owner._upstreamNodes??null}};export{u as _WebAudioBus};
//# sourceMappingURL=webAudioBus-SC4wRoJm.esm.min.js.map
