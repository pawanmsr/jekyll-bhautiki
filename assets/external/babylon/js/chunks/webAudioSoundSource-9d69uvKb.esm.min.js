import{A as e}from"./abstractSoundSource-WGnl6Tud.esm.min.js";import{_ as s,b as t,c as o,d as i}from"./spatialWebAudio-B42xkSFp.esm.min.js";import"./webAudioBaseSubGraph-BwJfROV_.esm.min.js";import"./audioEngine-Dxu8PeXf.esm.min.js";import"./index-C7lpuH7l.esm.min.js";class n extends e{constructor(e,s,t,o){super(e,t,o),this._stereo=null,this._webAudioNode=null,this._audioContext=this.engine._audioContext,this._webAudioNode=s,this._subGraph=new n._SubGraph(this)}async _initAsync(e){e.outBus?this.outBus=e.outBus:!1!==e.outBusAutoDefault&&(await this.engine.isReadyPromise,this.outBus=this.engine.defaultMainBus),await this._subGraph.initAsync(e),s(e)&&this._initSpatialProperty(),this.engine._addNode(this)}get _inNode(){return this._webAudioNode}get _outNode(){return this._subGraph._outNode}get stereo(){return this._stereo??(this._stereo=new t(this._subGraph))}dispose(){if(super.dispose(),this._webAudioNode){if(this._webAudioNode instanceof MediaStreamAudioSourceNode)for(const e of this._webAudioNode.mediaStream.getTracks())e.stop();this._webAudioNode.disconnect(),this._webAudioNode=null}this._stereo=null,this._subGraph.dispose(),this.engine._removeNode(this)}getClassName(){return"_WebAudioSoundSource"}_connect(e){return!!super._connect(e)&&(e._inNode&&this._outNode?.connect(e._inNode),!0)}_disconnect(e){return!!super._disconnect(e)&&(e._inNode&&this._outNode?.disconnect(e._inNode),!0)}_createSpatialProperty(e,s){return new o(this._subGraph,e,s)}}n._SubGraph=class extends i{get _downstreamNodes(){return this._owner._downstreamNodes??null}get _upstreamNodes(){return this._owner._upstreamNodes??null}_onSubNodesChanged(){super._onSubNodesChanged(),this._owner._inNode?.disconnect(),this._owner._subGraph._inNode&&this._owner._inNode?.connect(this._owner._subGraph._inNode)}};export{n as _WebAudioSoundSource};
//# sourceMappingURL=webAudioSoundSource-9d69uvKb.esm.min.js.map
